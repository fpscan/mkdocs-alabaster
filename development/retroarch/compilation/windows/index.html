
<!DOCTYPE html>
<html>
<head>
  
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <title>Windows 7 and later (MSYS2) &mdash; Alabaster</title>

    <link rel="shortcut icon" href="../../../../img/favicon.ico">
    <link rel="stylesheet" href="../../../../css/alabaster.css" type="text/css">
    <link rel="stylesheet" href="../../../../css/alabaster-overrides.css" type="text/css">

    

    
      <script src="../../../../search/main.js"></script>
    

    

    <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

    
  
</head>
<body>

  <div class="document">
    <div class="documentwrapper">
      <div class="bodywrapper">
        <div class="body" role="main">
          
            <h1 id="windows-7-and-later-compilation-and-development-guide">Windows 7 and later compilation and development guide<a class="headerlink" href="#windows-7-and-later-compilation-and-development-guide" title="Permanent link">¶</a></h1>
<p>!!! Warning
    The MinGW toolchain we use in this guide no longer supports targeting Windows Vista or earlier.
    Please refer to one of the MSVC guides for how to target older Windows versions with Visual Studio.</p>
<p><a href="http://www.youtube.com/watch?v=OaYvc3y3VLI"><img alt="Build in Windows" src="http://img.youtube.com/vi/OaYvc3y3VLI/0.jpg" /></a></p>
<p>This video covers quick demonstrations of these subjects;</p>
<ol>
<li>
<p>Environment Configuration</p>
</li>
<li>
<p>Building RetroArch</p>
</li>
<li>
<p>Packaging RetroArch</p>
</li>
</ol>
<p>Be sure to read instructions that are given in this page.</p>
<h2 id="environment-configuration">Environment configuration<a class="headerlink" href="#environment-configuration" title="Permanent link">¶</a></h2>
<p>We recommend MinGW-W64 from MSYS2. You can download MSYS2 installer from <a href="http://msys2.github.io/">here</a>.</p>
<p>Follow the installation instructions and once finished start the MSYS2 shell.</p>
<p>MSYS2 shell is a maintenance shell. We are going to use this shell to install the toolchain and other packages. First order of business is to update MSYS2. Start the MSYS2 Shell and run the following commands:</p>
<pre><code class="bash">pacman --noconfirm -Sy
pacman --needed --noconfirm -S bash pacman pacman-mirrors msys2-runtime
</code></pre>

<p>Close MSYS2 shell and start it again, and:</p>
<pre><code class="bash">pacman --noconfirm -Su
</code></pre>

<p>Restart MSYS2 once again. In some cases you may find out that the shell starting scripts don't work. If so check the following Note.</p>
<p>!!! Warning
    If you are updating from a very old MSYS2 installation you may need to update your shortcuts to reflect changes in MSYS2's subsystem. If the shell no longer works properly you need to update your shortcuts with the following targets:</p>
<pre><code>- MinGW-w64 Shell: `MSYS2_ROOT\msys2_shell.cmd -mingw64`
- MinGW-w32 Shell: `MSYS2_ROOT\msys2_shell.cmd -mingw32`
- MSYS2 Shell: `MSYS2_ROOT\msys2_shell.cmd -msys`
</code></pre>
<p>Now we can start installing the packages we actually need.</p>
<p>For 32-bit builds:</p>
<pre><code class="bash">pacman -S --noconfirm --needed wget git make mingw-w64-i686-toolchain mingw-w64-i686-ntldd mingw-w64-i686-zlib mingw-w64-i686-pkg-config mingw-w64-i686-SDL2 mingw-w64-i686-libxml2 mingw-w64-i686-freetype mingw-w64-i686-python3 mingw-w64-i686-ffmpeg mingw-w64-i686-drmingw
</code></pre>

<p>For 64-bit builds:</p>
<pre><code class="bash">pacman -S --noconfirm --needed wget git make mingw-w64-x86_64-toolchain mingw-w64-x86_64-ntldd mingw-w64-x86_64-zlib mingw-w64-x86_64-pkg-config mingw-w64-x86_64-SDL2 mingw-w64-x86_64-libxml2 mingw-w64-x86_64-freetype mingw-w64-x86_64-python3 mingw-w64-x86_64-ffmpeg mingw-w64-x86_64-drmingw
</code></pre>

<p>You might want to install Qt too if you want to be able to use the desktop GUI.</p>
<p>For 32-bit builds:</p>
<pre><code class="bash">pacman -S --noconfirm --needed mingw-w64-i686-qt5 mingw-w64-i686-openssl
</code></pre>

<p>For 64-bit builds:</p>
<pre><code class="bash">pacman -S --noconfirm --needed mingw-w64-x86_64-qt5  mingw-w64-x86_64-openssl
</code></pre>

<p>The NVIDIA CG toolkit package hasn't been updated for a while so you need to download that package manually and install with pacman. You can download the packages from sourceforge at the following locations: <a href="http://sourceforge.net/projects/msys2/files/REPOS/MINGW_GCC_4_9/i686/mingw-w64-i686-nvidia-cg-toolkit-3.1-2-any.pkg.tar.xz/download">32-bit</a> / <a href="http://sourceforge.net/projects/msys2/files/REPOS/MINGW_GCC_4_9/x86_64/mingw-w64-x86_64-nvidia-cg-toolkit-3.1-2-any.pkg.tar.xz/download">64-bit</a>. Alternatively you can use the following commands directly:</p>
<p>For 32-bit builds:</p>
<pre><code class="bash">wget http://sourceforge.net/projects/msys2/files/REPOS/MINGW_GCC_4_9/i686/mingw-w64-i686-nvidia-cg-toolkit-3.1-2-any.pkg.tar.xz/download -O mingw-w64-i686-nvidia-cg-toolkit-3.1-2-any.pkg.tar.xz
pacman -U mingw-w64-i686-nvidia-cg-toolkit-3.1-2-any.pkg.tar.xz
</code></pre>

<p>For 64-bit builds:</p>
<pre><code class="bash">wget https://sourceforge.net/projects/mingw-w64-archlinux/files/x86_64/mingw-w64-nvidia-cg-toolkit-3.1-2-any_4.pkg.tar.xz/download -O mingw-w64-x86_64-nvidia-cg-toolkit-3.1-2-any.pkg.tar.xz
pacman -U mingw-w64-x86_64-nvidia-cg-toolkit-3.1-2-any.pkg.tar.xz
</code></pre>

<p>Once these packages are installed close MSYS2 shell and open MinGW-w32 shell or MinGW-w64 shell depending on the platform you want to build for.</p>
<p>You'll need gcc and make:</p>
<pre><code class="bash">pacman -S make
pacman -S gcc
</code></pre>

<h2 id="retroarch-compilation">RetroArch Compilation<a class="headerlink" href="#retroarch-compilation" title="Permanent link">¶</a></h2>
<h3 id="building-retroarch">Building RetroArch<a class="headerlink" href="#building-retroarch" title="Permanent link">¶</a></h3>
<p>The first step is to obtain RetroArch's source tree.
You can find the repository directly at <a href="https://github.com/libretro/RetroArch">GitHub</a></p>
<p>Start the MINGW64 or the MINGW32 shell depending on what you want to compile and run the following commands:</p>
<pre><code class="bash">git clone https://github.com/libretro/RetroArch.git retroarch
</code></pre>

<p>For subsequent builds you will need to pull the changes from the repo</p>
<pre><code class="bash">cd retroarch
git pull
</code></pre>

<p>To compile RetroArch run the following commands inside RetroArch's source tree:</p>
<pre><code class="bash">./configure
make clean
make -j4
</code></pre>

<p>For development purposes you might want to run a debug build instead. In such case use the following commands:</p>
<pre><code class="bash">./configure
make clean
make DEBUG=1 GL_DEBUG=1 -j4
</code></pre>

<p>To facilitate debugging you can get an integrated crash handler by replacing the configure step with (debug builds only):</p>
<pre><code> ./configure --enable-drmingw
</code></pre>
<p>After a few minutes you should be able to find retroarch.exe under that directory. To start the newly compiled retroarch you can use:</p>
<pre><code class="bash">./retroarch
</code></pre>

<h3 id="packaging-retroarch">Packaging RetroArch<a class="headerlink" href="#packaging-retroarch" title="Permanent link">¶</a></h3>
<p>You might not be able to start your own build outside that environment. You might want to try to get all the required DLLs by running the following script in your destination RetroArch folder (not the git repo folder):</p>
<pre><code class="bash">for i in $(seq 3); do for bin in $(ntldd -R *exe | grep -i mingw | cut -d&quot;&gt;&quot; -f2 | cut -d&quot; &quot; -f2); do cp -vu &quot;$bin&quot; . ; done; done
</code></pre>

<p>If Qt is enabled for your build (detected automatically by default), the following is also needed:</p>
<pre><code class="bash">windeployqt --release --no-patchqt --no-translations retroarch.exe
for i in $(seq 3); do for bin in $(ntldd -R imageformats/*dll | grep -i mingw | cut -d&quot;&gt;&quot; -f2 | cut -d&quot; &quot; -f2); do cp -vu &quot;$bin&quot; . ; done; done
</code></pre>

<p>If you really want to get the required libraries for distribution or for personal use on other devices and LDD doesn't work for you for whatever reason, then you can try <a href="http://www.dependencywalker.com/">Dependency Walker</a>. </p>
<p>!!! tip
    If you're building frequently you may want to add <strong>ccache</strong> to the mix to speed up the build process. 
    Install ccache via the package manager and the prepend the ccache symlink directory to your build environment path as shown below. </p>
<pre><code>For further instructions check the [documentation](https://ccache.samba.org/manual.html#_run_modes)
</code></pre>
<p>Install <strong>ccache</strong> for 32-bit builds:</p>
<pre><code class="bash">pacman -S --noconfirm --needed make mingw-w64-i686-ccache
</code></pre>

<p>Install <strong>ccache</strong> for 64-bit builds:</p>
<pre><code class="bash">pacman -S --noconfirm --needed mingw-w64-x86_64-ccache
</code></pre>

<p>Configure paths for 32-bit builds:</p>
<pre><code class="bash">export PATH=/mingw32/lib/ccache/bin/:$PATH
</code></pre>

<p>Configure paths for 64-bit builds:</p>
<pre><code class="bash">export PATH=/mingw64/lib/ccache/bin/:$PATH
</code></pre>

<p>!!! tip
    You can add this to /etc/profile under both the 32-bit and 64-bit setups by adding <code>${MINGW_MOUNT_POINT}/lib/ccache/bin</code> to the front of the PATH variables found in <code>MINGW32)</code> and <code>MINGW64)</code>, around line 50 of profile, to ensure the proper binaries are loaded for each development environment.</p>
<p>From our own buildbot, the times with and without <strong>ccache</strong> are the following:</p>
<p>Without <strong>ccache</strong>:</p>
<pre><code>real    2m7.645s
user    0m2.585s
sys     0m11.527s
</code></pre>
<p>With <strong>ccache</strong>:</p>
<pre><code>real    0m25.466s
user    0m2.902s
sys     0m9.952s
</code></pre>
<p>!!! tip
    You can also strip the debug symbols of the build product to save some space.</p>
<p>Strip <strong>retroarch</strong>: </p>
<pre><code class="bash">strip -s retroarch.exe
</code></pre>

<h2 id="core-compilation">Core Compilation<a class="headerlink" href="#core-compilation" title="Permanent link">¶</a></h2>
<h3 id="fetching-cores">Fetching Cores<a class="headerlink" href="#fetching-cores" title="Permanent link">¶</a></h3>
<p>You can find the cores on libretro's <a href="https://github.com/libretro/">GitHUB organization</a>. </p>
<p>We have an all-in-one tool to fetch and compile cores which you can use to streamline the process.
You can obtain the tool by using these commands:</p>
<pre><code class="bash">git clone https://github.com/libretro/libretro-super.git
cd libretro-super
</code></pre>

<p>Then you can fetch one or all the cores by using <strong>libretro-fetch.sh</strong></p>
<p>Fetch all cores:</p>
<pre><code class="bash">./libretro-fetch.sh
</code></pre>

<p>Fetch one core:</p>
<pre><code class="bash">./libretro-fetch.sh *corename*
</code></pre>

<p>!!! Note
     Replace <em>corename</em> with the name of the core you want to fetch, for example gambatte</p>
<h3 id="building-cores">Building Cores<a class="headerlink" href="#building-cores" title="Permanent link">¶</a></h3>
<h4 id="libretro-super">libretro-super<a class="headerlink" href="#libretro-super" title="Permanent link">¶</a></h4>
<p>The easiest way to build all the cores is to use <strong>libretro-build.sh</strong> from within libretro-super's source tree:</p>
<pre><code class="bash">./libretro-build.sh
</code></pre>

<p>In case you only want to build one and/or more cores instead of all, you can specify the cores you want to build after the first command in no particular order:</p>
<pre><code class="bash">./libretro-build.sh snes9x2010 fceumm
</code></pre>

<p>Once compilation has finished, you can find the libretro cores inside <em>dist/win</em>.</p>
<h4 id="manual-fetching-and-compilation">Manual Fetching and Compilation<a class="headerlink" href="#manual-fetching-and-compilation" title="Permanent link">¶</a></h4>
<p>Get the core's source tree. As an example we'll use <a href="https://github.com/libretro/libretro-fceumm/">fceumm</a></p>
<pre><code class="bash">git clone https://github.com/libretro/libretro-fceumm.git
</code></pre>

<p>Then compile the core: </p>
<pre><code class="bash">cd libretro-fceumm
make -f Makefile.libretro
</code></pre>

<p>Optionally strip the build product:</p>
<pre><code class="bash">strip fceumm_libretro.dll
</code></pre>

<p>Most cores will build with these instructions. You might need to browse to a subdirectory in some cases.</p>
<h4 id="video-tutorial">Video Tutorial<a class="headerlink" href="#video-tutorial" title="Permanent link">¶</a></h4>
<p><a href="http://www.youtube.com/watch?v=OaYvc3y3VLI"><img alt="Quick Video Demonstration" src="http://img.youtube.com/vi/OaYvc3y3VLI/0.jpg" /></a></p>
            
          
        </div>
      </div>
    </div>
    <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
      <div class="sphinxsidebarwrapper">
        
          
            
  <p class="logo">
    <a href="../../../..">
      <img class="logo" src="../../../../logo.png" title="Alabaster">
    </a>
  </p>
  



          
            



<h3>Table Of Contents</h3>

<nav>
  
  
    <ul>
    
      <li><a href="#environment-configuration">Environment configuration</a></li>
      <ul>
    
  </ul>
    
      <li><a href="#retroarch-compilation">RetroArch Compilation</a></li>
      <ul>
    
      <li><a href="#building-retroarch">Building RetroArch</a></li>
      <ul>
    
  </ul>
    
      <li><a href="#packaging-retroarch">Packaging RetroArch</a></li>
      <ul>
    
  </ul>
    
  </ul>
    
      <li><a href="#core-compilation">Core Compilation</a></li>
      <ul>
    
      <li><a href="#fetching-cores">Fetching Cores</a></li>
      <ul>
    
  </ul>
    
      <li><a href="#building-cores">Building Cores</a></li>
      <ul>
    
      <li><a href="#libretro-super">libretro-super</a></li>
      <ul>
    
  </ul>
    
      <li><a href="#manual-fetching-and-compilation">Manual Fetching and Compilation</a></li>
      <ul>
    
  </ul>
    
      <li><a href="#video-tutorial">Video Tutorial</a></li>
      <ul>
    
  </ul>
    
  </ul>
    
  </ul>
    
  </ul>
  

  
    <hr>
    <ul>
      
        <li class="toctree-l1"><a href="https://github.com/notpushkin/mkdocs-alabaster">Fork me on GitHub</a></li>
      
    </ul>
  
</nav>
          
            
  <h3>Related Topics</h3>
  <ul>
    
      <li>Previous: <a href="../haiku/" title="previous chapter">
        Haiku
      </a></li>
    
    
      <li>Next: <a href="../msvc-runtime-versions/" title="next chapter">
        MSVC Compatibility Guide
      </a></li>
    
  </ul>

          
            <div id="searchbox" style="display: none;" role="search">
  <h3>Quick search</h3>
  <form class="search" action="../../../../search.html" method="get">
    <input name="q" type="text">
    <input value="Go" type="submit">
  </form>
  <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
  </p>
</div>
<script type="text/javascript">
  document.getElementById("searchbox").style.display = "block";
</script>
          
        
      </div>
    </div>
    <div class="clearer"></div>
  </div>

  
    <div class="footer">
      
        &copy; 2019 Alexander Pushkov
      
      
        |
        Powered by <a href="http://www.mkdocs.org">mkdocs 1.1</a>
        &amp; <a href="https://github.com/iamale/mkdocs-alabaster">mkdocs-alabaster</a>
      
    </div>
  

  <!--
  MkDocs version      : 1.1
  Docs Build Date UTC : 2020-05-14 06:50:09
  -->
</body>
</html>