
<!DOCTYPE html>
<html>
<head>
  
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <title>Video Recording and Streaming &mdash; Alabaster</title>

    <link rel="shortcut icon" href="../../img/favicon.ico">
    <link rel="stylesheet" href="../../css/alabaster.css" type="text/css">
    <link rel="stylesheet" href="../../css/alabaster-overrides.css" type="text/css">

    

    
      <script src="../../search/main.js"></script>
    

    

    <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

    
  
</head>
<body>

  <div class="document">
    <div class="documentwrapper">
      <div class="bodywrapper">
        <div class="body" role="main">
          
            <h1 id="recording-and-streaming-video-from-retroarch">Recording and streaming video from RetroArch<a class="headerlink" href="#recording-and-streaming-video-from-retroarch" title="Permanent link">¶</a></h1>
<p>RetroArch has the capability to record gaming footage in real-time using libavcodec (FFmpeg).
Both lossless and lossy coding is supported. It is possible to configure most encoding options
for libavcodec using a separate config file.</p>
<h2 id="ffmpeg-version">FFmpeg version<a class="headerlink" href="#ffmpeg-version" title="Permanent link">¶</a></h2>
<p>RetroArch requires a very recent version of FFmpeg to work correctly.
If you are on Linux or OSX, your distros FFmpeg build is likely out of date, and you should build FFmpeg from Git. A recommended command line is:</p>
<pre><code>./configure --prefix=/opt/ffmpeg --enable-libx264 --enable-gpl --enable-libmp3lame &lt;enable stuff you fancy here&gt;
make
sudo make install
</code></pre>
<p>This assumes you will install a custom FFmpeg build into <code>/opt/ffmpeg</code>.
For Windows users, the redist includes recent enough libav* binaries.</p>
<p>Now you can configure RetroArch with:</p>
<pre><code>PKG_CONFIG_PATH=/opt/ffmpeg/lib/pkgconfig ./configure
</code></pre>
<p>and the configure script should pick up the FFmpeg libraries in <code>/opt/ffmpeg/lib</code>. Check config.mk
to make sure. After successfully compiling, make sure that the RetroArch binary picks up the correct FFmpeg libs by adding <code>/opt/ffmpeg/lib</code> to LD_LIBRARY_PATH (or the equivalent on OSX).</p>
<h2 id="lossless-coding">Lossless coding<a class="headerlink" href="#lossless-coding" title="Permanent link">¶</a></h2>
<p>By default (not providing an encoding config), lossless coding is used. This means libx264/RGB, with -qp 0 (lossless). The audio codec used is FLAC. libx264/RGB ensures very nice bitrates even when lossless and very fast encoding.</p>
<h2 id="lossy-and-flexible-coding-config">Lossy and flexible coding config<a class="headerlink" href="#lossy-and-flexible-coding-config" title="Permanent link">¶</a></h2>
<p>By adding the <code>--recordconfig &lt;config&gt;</code> parameter, you have more control over encoding.
The recognized config options are:</p>
<pre><code>vcodec = &lt;codec&gt; # Same as -vcodec
acodec = &lt;codec&gt; # Same as -acodec
format = &lt;format&gt; # Muxer format to use. E.g. mkv, flv or mp4. This is normally inferred, but must be set when using extensionless formats like RTMP (streaming).
threads = &lt;threads&gt; # Threads to use when encoding video. Should be set to (# of CPU threads - 1).
frame_drop_ratio = &lt;ratio&gt; # Only encodes every &lt;ratio&gt; frames.
pix_fmt = &lt;pix_fmt&gt; # Same as -pix_fmt, no default is assumed, must be set!
scale_factor = &lt;factor&gt; # Scales input by &lt;factor&gt;. Useful when encoding in chroma subsampled formats like yuv420p.
sample_rate = &lt;rate&gt; # Audio output sampling rate.
audio_global_quality = &lt;qual&gt; # Global quality for audio (VBR). Maps to codec-&gt;global_quality in API. Play around with it. Higher = better. 75 seems to be a fair value.
audio_bit_rate = &lt;bitrate&gt; # Audio bit rate (CBR). This is in bit/s, so use e.g. 192000 for 192 kb/s.

video_{option} = &lt;value&gt; # Sets generic video option {option} to &lt;value&gt;. This is codec specific. Mostly useful for libx264.
audio_{option} = &lt;value&gt; # Sets generic audio option {option} to &lt;value&gt;. This is codec specific.
</code></pre>
<h2 id="live-streaming">Live streaming<a class="headerlink" href="#live-streaming" title="Permanent link">¶</a></h2>
<p>RetroArch can live stream to RTMP services like <a href="http://www.twitch.tv/">twitch</a>.
To live stream there, create a config that is tailored for twitch. Example:</p>
<pre><code>vcodec = libx264
acodec = libmp3lame
pix_fmt = yuv420p
scale_factor = 2
threads = 3
video_crf = 25
video_preset = superfast
video_tune = animation
audio_global_quality = 75
sample_rate = 44100
format = flv
</code></pre>
<p>You can stream to twitch with a command such as:</p>
<pre><code>retroarch --record rtmp://live.twitch.tv/app/$YOUR_TWITCH_ID --recordconfig twitch.cfg
</code></pre>
            
          
        </div>
      </div>
    </div>
    <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
      <div class="sphinxsidebarwrapper">
        
          
            
  <p class="logo">
    <a href="../..">
      <img class="logo" src="../../logo.png" title="Alabaster">
    </a>
  </p>
  



          
            



<h3>Table Of Contents</h3>

<nav>
  
  
    <ul>
    
      <li><a href="#ffmpeg-version">FFmpeg version</a></li>
      <ul>
    
  </ul>
    
      <li><a href="#lossless-coding">Lossless coding</a></li>
      <ul>
    
  </ul>
    
      <li><a href="#lossy-and-flexible-coding-config">Lossy and flexible coding config</a></li>
      <ul>
    
  </ul>
    
      <li><a href="#live-streaming">Live streaming</a></li>
      <ul>
    
  </ul>
    
  </ul>
  

  
    <hr>
    <ul>
      
        <li class="toctree-l1"><a href="https://github.com/notpushkin/mkdocs-alabaster">Fork me on GitHub</a></li>
      
    </ul>
  
</nav>
          
            
  <h3>Related Topics</h3>
  <ul>
    
      <li>Previous: <a href="../retroarch-accessibility-guide/" title="previous chapter">
        Guide
      </a></li>
    
    
      <li>Next: <a href="../troubleshooting-retroarch/" title="next chapter">
        Troubleshooting
      </a></li>
    
  </ul>

          
            <div id="searchbox" style="display: none;" role="search">
  <h3>Quick search</h3>
  <form class="search" action="../../search.html" method="get">
    <input name="q" type="text">
    <input value="Go" type="submit">
  </form>
  <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
  </p>
</div>
<script type="text/javascript">
  document.getElementById("searchbox").style.display = "block";
</script>
          
        
      </div>
    </div>
    <div class="clearer"></div>
  </div>

  
    <div class="footer">
      
        &copy; 2019 Alexander Pushkov
      
      
        |
        Powered by <a href="http://www.mkdocs.org">mkdocs 1.1</a>
        &amp; <a href="https://github.com/iamale/mkdocs-alabaster">mkdocs-alabaster</a>
      
    </div>
  

  <!--
  MkDocs version      : 1.1
  Docs Build Date UTC : 2020-05-14 06:50:09
  -->
</body>
</html>